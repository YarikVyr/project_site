{% extends "base.html" %}

{% block content %}
<div class="flex flex-col min-h-screen">
    <main class="flex-grow container mx-auto px-4 md:px-8 max-w-7xl">
        <h1 class="text-4xl font-bold mt-8 mb-6 text-left">{{ category_name }}</h1>
        
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Карточка -->
            {% for item in shop %}
            <div class="bg-white p-4 rounded-lg shadow-lg text-center">
                <img src="{{ url_for('static', filename='img/' + (item.get('image link') or 'placeholder.jpg')) }}"
                     alt="{{ item.get('clothes name', 'Неизвестный товар') }}"
                     class="w-full aspect-[2/3] rounded-md mb-2 object-cover">
                <h3 class="font-semibold text-lg">{{ item.get('clothes name', 'Неизвестный товар') }}</h3>
                <p class="text-gray-600 mb-4">{{ item.get('price', 'N/A') }} ₽</p>
                <button class="bg-[#EE9732] hover:bg-[#D4892E] text-white font-bold py-2 px-6 rounded-full transition-colors"
                        onclick="showForm({{ item.get('id', '') | tojson }}, {{ item.get('clothes name', 'Неизвестный товар') | tojson }})">
                    Купить
                </button>
            </div>
            {% endfor %}
        </div>
    </main>

    <!-- Модальное окно (форма заявки) -->
    <div id="order-form-modal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <h3 class="text-lg font-bold mb-4">Форма заявки на товар</h3>
            <form action="{{ url_for('handle_order') }}" method="post">
                <input type="hidden" id="product_id" name="product_id">
                <input type="hidden" id="product_name" name="product_name">
                <div class="mb-4">
                    <label for="name" class="block text-sm font-medium text-gray-700">Ваше имя:</label>
                    <input type="text" id="name" name="name" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div class="mb-4">
                    <label for="phone" class="block text-sm font-medium text-gray-700">Номер телефона:</label>
                    <input type="tel" id="phone" name="phone" required
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50">
                </div>
                <div class="mt-4 flex justify-end space-x-2">
                    <button type="button" onclick="hideForm()"
                        class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-full transition-colors">
                        Отмена
                    </button>
                    <button type="submit"
                        class="bg-[#EE9732] hover:bg-[#D4892E] text-white font-bold py-2 px-4 rounded-full transition-colors">
                        Отправить заявку
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    function showForm(productId, productName) {
        document.getElementById('product_id').value = productId;
        document.getElementById('product_name').value = productName;
        document.getElementById('order-form-modal').classList.remove('hidden');
    }

    function hideForm() {
        document.getElementById('order-form-modal').classList.add('hidden');
    }
</script>
{% endblock %}